@using FinanceManager.Domain.Services

@inherits LayoutComponentBase
@inject NavigationManager Navigation
@inject ILoginService LoginService

<AuthorizeView>
    <NotAuthorized>
        <RedirectToLogin />
    </NotAuthorized>
    <Authorized>
        <MudLayout>
            <MudDrawer @bind-Open="_drawerOpen" Elevation="0">
                <NavMenu />
                <MudSpacer />

                @* <LoginDisplay /> *@

                <MudNavMenu>
                    <MudNavLink Icon="@Icons.Material.Filled.Settings" href="UserSettings">Settings</MudNavLink>
                    <MudNavLink Icon="@Icons.Material.Filled.Logout" @onclick=LogOut>Log out</MudNavLink>
                </MudNavMenu>
            </MudDrawer>
            <MudMainContent Class="pt-2">
                @Body
            </MudMainContent>
        </MudLayout>
    </Authorized>
</AuthorizeView>

@code {

    bool _drawerOpen = true;

    private async Task LogOut()
    {
        await LoginService.Logout();
        Navigation.NavigateTo("login");
    }
    void DrawerToggle()
    {
        _drawerOpen = !_drawerOpen;
    }
}